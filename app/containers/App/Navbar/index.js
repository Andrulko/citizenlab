import React, { PropTypes } from 'react';
import { push } from 'react-router-redux';
import styled from 'styled-components';
import { lighten } from 'polished';
import { Link } from 'react-router';
import { FormattedMessage, injectIntl } from 'react-intl';
// import SearchWidget from 'containers/SearchWidget';
import Authorize from 'utils/containers/authorize';
import { createStructuredSelector } from 'reselect';
import { preprocess } from 'utils';
import { signOutCurrentUser } from 'utils/auth/actions';
import { makeSelectCurrentUserImmutable } from 'utils/auth/selectors';
import ClickOutside from 'utils/containers/clickOutside';
import messages from './messages';
// import { media } from '/utils/styleUtils';

const Container = styled.div`
  width: 100%;
  display: flex;
  justify-content: space-between;
  padding-top: 10px;
  padding-bottom: 10px;
  padding-left: 30px;
  padding-right: 30px;
  position: relative;
  background: #fff;
  border-bottom: solid 1px #ccc;
  z-index: 1;
`;

const Left = styled.div`
  display: flex;

  > div {
    display: flex;
  }
`;

const MenuItems = styled.div`
  height: 100%;
  display: flex;
  margin-left: 25px;
`;

const MenuItem = styled(Link)`
  height: 100%;
  font-size: 18px;
  font-weight: 500;
  color: ${(props) => props.active ? '#00a8e2' : '#444'};
  text-transform: uppercase;
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 15px;
  padding-right: 15px;
  cursor: pointer;
`;

const Right = styled.div`
  display: flex;

  > div {
    display: flex;
  }
`;

const Logo = styled.svg`
  fill: #023F88;
  height: 40px;
  cursor: pointer;
`;

const ButtonIcon = styled.svg`
  fill: #fff;
  height: 32px;
  margin-top: -8px;
`;

const ButtonText = styled.span`
  color: #fff;
  font-weight: 500;
  font-size: 18px;
  white-space: nowrap;
  transition: opacity 150ms ease;
`;

const Button = styled.div`
  height: 45px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0px 20px;
  border-radius: 6px;
  background: #00a8e2;
  cursor: pointer;
  transition: all 200ms ease-out;
  margin-right: 10px;
  background: ${(props) => props.secondary ? 'transparent' : '#00a8e2'};

  &:hover {
    background: ${(props) => !props.secondary ? lighten(0.1, '#00a8e2') : ''};

    ${ButtonText} {
      opacity: 1;
    }
  }

  ${ButtonText} {
    opacity: ${(props) => props.secondary ? '0.7' : '1'};
  }
`;

const User = styled(ClickOutside)`
  display: flex;
  border-radius: 50%;
  margin-left: 0px;
  position: relative;
  cursor: pointer;
`;

const UserImage = styled.img`
  height: 41px;
  border-radius: 50%;
  margin-left: 10px;
  opacity: 0.75;
  transition: opacity 200ms ease;

  &:hover {
    opacity: 1;
  }
`;

const Dropdown = styled.div`
  min-width: 150px;
  display: flex;
  flex-direction: column;
  position: absolute;
  top: 50px;
  right: -5px;
  z-index: 1;
  border-radius: 6px;
  border: solid 1px #ccc;
  overflow: hidden;
`;

const DropdownItem = styled.div`
  color: #666;
  font-size: 15px;
  font-weight: 400;
  padding: 8px 10px;
  border-bottom: solid 1px #eee;
  background: #fff;

  &:last-child {
    border: none;
  }

  &:hover {
    background: #f4f4f4;
  }
`;

class Navbar extends React.PureComponent { // eslint-disable-line react/prefer-stateless-function
  constructor() {
    super();

    this.state = {
      dropdownOpened: false,
    };
  }

  toggleDropdown = () => {
    this.setState((state) => ({ dropdownOpened: !state.dropdownOpened }));
  }

  closeDropdown = () => {
    this.setState({ dropdownOpened: false });
  }

  goTo = (path) => () => {
    this.props.goTo(path);
  }

  render() {
    const { currentUser } = this.props;
    const avatar = (currentUser ? currentUser.getIn(['attributes', 'avatar', 'large']) : null);
    // #023F88
    return (
      <Container>
        <Left>
          <Link to="/">
            <Logo height="100%" viewBox="0 0 443.04 205.82">
              <path d="M344.828 80.286c-1.05 4.29-2.222 8.55-3.39 12.813-2.097 7.662-4.195 15.324-6.37 22.964-.207.73-.785 1.965-1.428 1.965-.67 0-1.096-1.333-1.292-2.574-.796-5.18.99-12.942 2.502-18.593 1.756-6.567 2.754-8.724 5.13-15.002 1.17-2.745 3.29-4.56 4.514-4.09.39.15.53 1.71.334 2.516m-90.414 10.25c.573-2.724 1.207-5.45 2.07-8.093.836-2.564 1.86-5.087 3.028-7.52.872-1.813 1.492-1.653 2.58.087 1.068 1.71 1.227 3.42 1.22 4.945-.052 5.007-1.27 8.968-5.114 11.732-.386.278-1.245.73-1.683.86-1.183.25-2.563.448-2.563.448s.316-1.772.462-2.46M374.93 117.52c-.572-2.09-1.21-4.193-1.456-6.335-.79-6.875-1.427-13.768-2.097-20.658-.312-3.224-.608-6.452-.837-9.684-.174-2.505-.278-5.018-.32-7.53-.052-2.922-.227-20.313-.018-26.064.194-5.34 1.065-10.65 1.577-15.98.67-6.963 1.248-13.918 1.272-20.938.017-4.468-3.07-7.455-6.742-8.585-2.573-.792-5.28-1.14-7.924-1.707-.88-.188-.998.29-1.114.998-.818 4.964-1.66 9.925-2.523 14.882-1.915 10.98-4.69 21.805-5.766 32.933-.398 4.122-.96 8.23-1.38 12.35-.283 2.77-.438 5.554-.667 8.33-.093 1.124-.53 1.886-1.83 2.038-5.02.584-8.586 3.288-11.216 7.537-4.642 7.505-7.764 15.572-9.39 24.23-.652 3.467-1.204 6.955-1.966 10.396-.536 2.425-2.16 7.186-3.164 7.19-.63-.183-1.008-1.972-1.056-2.452-.284-2.896-.235-5.206-.356-8.112-.093-2.234.527-18.912.543-19.25.17-3.524.56-9.06.385-12.57-.08-1.628-.15-2.674-1.005-4.176-.513-.887-1.993-1.622-2.99-1.8-3.196-.575-8.444-.104-11.76 3.425-4.82 5.135-7.355 10.225-10.5 16.542-1.333 2.677-2.152 5.083-3.653 7.675-.2.343-.716.858-1.06.762-.343-.095-.332-.857-.302-1.272.12-1.626.296-2.25.5-3.87.29-2.288.525-2.73.96-4.994.816-4.26 1.893-8.473 2.606-12.75.55-3.27.645-6.615 1.062-9.913.198-1.572-.147-2.91-1.358-3.834-1.834-1.402-3.743-2.723-5.716-3.922-1.56-.948-2.46-.517-3.16 1.185-.567 1.38-1.08 2.793-1.762 4.118-1.766 3.444-6.71 15.28-10.48 29.056-.746 3.542-1.338 5.89-2.36 8.893-1.204 3.532-2.708 6.985-4.346 10.342-1.577 3.233-3.406 6.356-5.318 9.405-.492.786-1.93 1.722-2.55 1.503-.853-.3-1.702-1.558-1.91-2.542-.62-2.907-1.214-5.875-1.28-8.832-.1-4.337.206-8.688.474-13.025.09-1.47.81-2.71 2.408-3.227 1.288-.416 2.59-.85 3.8-1.45 1.313-.656 2.737-1.252 3.726-2.333 4.746-6.123 4.29-9.55 4.466-12.522.176-2.97-.128-6.745-1.925-9.865-1.73-3.01-3.887-4.27-7.233-3.334-2.543.715-4.986 1.785-7.47 2.71-2.943 1.096-5.16 3.195-6.62 5.817-1.74 3.123-3.053 6.495-4.426 9.81-1.85 4.465-3.282 9.033-4.005 13.863-1.025 6.854-1.457 13.63.222 20.45 1.48 6.012 6.46 11.816 13.04 12.438 2.332.22 4.775.03 7.08-.424 2.702-.53 5.58-1.136 7.132-3.853 1.708-2.995 3.306-6.057 4.926-9.103.438-.82.78-1.688 1.354-2.943.924 2.536 1.514 4.646 2.467 6.58.53 1.072 1.502 2.22 2.56 2.683 2.78 1.22 5.834 1.454 8.81 1 1.232-.188 2.68-.978 3.426-1.955 2.448-3.208 4.153-6.775 4.877-10.862.65-3.657 1.71-7.26 2.837-10.808 2.737-8.613 5.743-13.958 8.66-18.858.92-1.544 1.865-2.934 3.484-4.69.865-.86 1.993-1.47 2.835-1.262 1.312.325-.54 4.58-1.117 5.887-1.122 2.553-2.5 5.008-3.446 7.623-3.135 8.675-5.46 17.536-5.238 26.867.052 2.227.187 4.476.562 6.665.315 1.836 1.025 3.608 1.592 5.4.14.442.347.89.622 1.26 1.27 1.703 2.88 2.92 5.062 3.097 2.23.18 4.48.428 6.706.336 3.127-.13 5.653-2.518 6.633-5.526.918-2.816 2.095-5.55 3.28-8.636.917.858 1.43 1.574 2.136 2.174.72.614 1.85 1.527 2.687 1.813 4.607 1.572 9.53.092 12.29-4.85 1.47-2.636 2.458-5.583 3.368-8.48 1.1-3.493 1.88-7.086 2.81-10.633.15-.574.368-1.13.555-1.697.173-.016.347-.032.52-.05.224 1.144.53 2.277.654 3.43.496 4.66.875 9.335 1.414 13.99.72 6.225 1.823 12.387 3.93 18.31 1.254 3.52 2.58 7.023 4.094 10.438 1.515 3.422 3.905 6.204 7.056 8.287 2.352 1.556 4.87 2.353 7.734 1.873 2.624-.44 3.188-1.15 3.11-3.795-.074-2.5-.24-5.034.073-7.498.39-3.085 1.116-6.144 1.906-9.16.673-2.574.17-5.015-.458-7.44-.918-3.536-2.045-7.014-3.008-10.536"/>
              <path d="M188.085 110.76c.938.84 2.583 4.012 2.913 8.457.084 1.597.058 2.643-.128 3.716-.32 1.83-.405 3.348-1.113 5.265-.46 1.248-1.777 2.046-3.323 1.853-4.227-.53-8.935-4.816-9.857-8.96-.422-1.896.102-3.6.913-5.3 1.194-2.506 2.353-5.03 3.37-7.61.193-.487.655-1.31.655-1.31s.607.327 1 .543c1.908 1.042 3.987 1.925 5.57 3.347m-34.4-19.614c-.135-.713-.53-2.85-.406-2.137-.164-.928.493-.943.63-.11-.117-.713.243 1.43.27 2.153.1 2.705-.392.593-.494.093m-1.592 3.92c-.456 6.897-1.663 13.682-4.513 20.018-1.242 2.762-3.037 5.29-4.718 7.832-1.22 1.847-3.203 2.707-5.26 3.302-2.012.582-3.637-.138-4.56-2.073-1.527-3.2-1.915-6.64-1.922-11.075.265-4.558.97-9.977 4.073-14.668 1.245-1.884 2.94-3.577 4.733-4.963 1.97-1.524 4.296-2.587 6.457-3.863 1.05-.62 2.127-1.212 3.11-1.93 1.495-1.094 2.052-.96 2.26.91.242 2.156.484 4.355.34 6.508m-17.732 34.987c4.35-.514 6.178-1.298 7.337-2.654.076-.09.194.13.292.194-.306.437-1.244 1.71-1.358 2.127.38.002.42.008.8 0 .196-.005.392-.045.605-.074-.775 2.02-3.997 2.564-6.68 1.12m-.586-2.604c-2.335-.2-4.404-1.12-6.013-2.923-1.302-1.46-2.045-2.567-2.906-4.314-.632-1.282-1.254-3.018-1.634-4.444-1.835-6.9-2.052-13.837-.574-20.823.11-.517.253-1.028.42-1.53.237-.703.612-1.62.53.05.042-.86-.104 1.73-.304 2.56-1.043 4.35-1.324 7.003-.256 11.273 0-.01.335.767.33.758.144.25.27 1.5.405 1.624 1.43 1.285 1.43 3.03 1.61 4.72-.31-.574-.377-1.39-.742-1.93-.38-.56-.783-.844-.6.272.236 1.44.657 2.86 1.064 4.23.456 1.545.995 3.115 1.816 4.486.783 1.306 1.824 2.568 3.032 3.48 1.206.907 5.043 2.353 4.234 2.034.346.135.028.52-.41.476m-7.095-9.404c.317.662-.27.904-.43.12.153.757-.3-1.516-.45-2.273l.88 2.153m130.158-60.002l-.028-.03 8.785-2.455-.073-.08c-2.655.744-9.132 1.885-9.23 1.78.372-.294.758-.568 1.11-.88 1.1-.97 1.033-1.257-.245-2.02-.208-.125-.376-.315-.62-.524 1.657-1.93 4.235-1.907 6.133-3.13 5.202-.84 12.885-2.592 14.63-3.31.377-.155.636-.595.95-.903-.386-.182-.76-.49-1.155-.523-2.598-.22-22.49 3.642-24.79 4.648l-1.022.145c-.988.1-.884-1.017-.063-1.185 7.526-2.162 15.052-3.47 22.58-5.633-1.532-.337-2.95-.277-4.363-.35-2.506-.13-5.007-.458-7.513-.495-9.11-.132-18.228-.363-27.22 1.64-2.766.617-3.257.216-3.257-2.68 0-5.714-.026-11.436.235-17.142.16-3.45.743-6.872 2.565-9.988.648-1.11.946-2.563.975-3.87.09-4.05-4.763-7.627-8.438-6.965-1.924.347-3.862.655-5.753 1.144-2.055.53-3.355 2.59-3.06 4.687.276 1.935-.053 3.68-.798 5.526-1.755 4.347-3.385 8.76-4.755 13.24-2.547 8.325-4.93 17.437-7.367 25.794-1.167 4-2.75 8.5-4.044 11.513-2.762 6.434-6.395 12.46-9.635 18.668-1.29 2.47-2.68 4.892-3.93 7.383-.215.426-1.646 2.64-2.048 3.575-.086-.075-.183-.127-.278-.176-4.39-2.296-8.758-6.4-5.106-13.19 1.31-2.437 2.652-4.614 5.762-5.25 1.41-.29 3.62-1.204 4.803-2.2 1.69-1.424 1.53-3.602.692-5.806-.883-2.32-2.668-3.453-5.087-3.835-2.185-.345-9.184.088-10.082-.017-1.25-.146-2.266-.024-2.986 1.166-1.126 1.856-2.42 3.616-3.443 5.525-.812 1.514-1.73 2.374-3.59 2.354-2.367.373-4.76.42-6.588.615-1.754.19-3.514.335-5.272.478-.99.08-1.64-.336-2.07-1.287-1.707-3.78-4.77-5.64-8.816-5.938-2.247-.165-4.296-1.512-6.707-.834-1.96.55-4.09.515-6.013 1.147-.95.314-1.763.76-2.837.69-1.185-.074-1.984.506-1.732 1.882.408 2.232-.24 4.282-1.013 6.327-2.56 6.788-4.3 13.784-4.813 21.024-.734 10.35 1.398 20.183 5.994 29.444 1.073 2.155 2.475 4.337 4.248 5.922 5.988 5.35 10.45 5.57 16.35 2.384 3.843-2.076 6.81-5.164 9.267-8.742 3.52-5.124 5.764-10.74 6.772-16.9 1.006-6.16 1.5-12.322.04-18.437-.767-3.226-2.04-6.333-3.107-9.485-.243-.72-.69-1.552.285-1.928 1.864-.72 4.914-1.27 6.943-1.933 0 3.286-.26 4.985-.252 7.962.007 3.323 1.4 7.56 3.357 10.18 2.278 3.054 3.91 4.957 7.185 7.174.81.548 2.524 1.734 2.524 1.734s-.685 1.088-1.06 1.64c-1.344 1.965-2.617 3.98-3.883 5.997-1.6 2.546-2.312 5.32-2.258 8.345.115 6.495 1.415 12.643 4.515 18.434 1.89 3.53 3.89 6.82 7.39 9.01 1.796 1.125 4.176.828 5.343-1.01 3.343-5.268 5.754-10.966 7.24-17 .807-3.283 1.167-6.685 1.605-10.047.645-4.968.68-9.93-1.683-14.515-.843-1.64-2.077-3.184-3.453-4.414-1.815-1.62-2.613-2.532-4.574-3.997-.572-.427-1.97-1.343-2.834-1.922-.092-.06 5.25-4.004 6.167-4.962 2.934-3.068 4.894-5.332 6.723-9.167 2.865-6.008 5.576-11.134 8.368-17.18.778-1.68 1.513-1.898 3.245-1.233 1.586.61 1.825 1.833 1.737 3.293-.31 5.094-.7 10.185-.882 15.284-.316 8.977-.668 17.96-.682 26.94-.01 6.468 1.628 12.65 4.517 18.483 1.115 2.25 2.055 4.588 3.094 6.877.29.637.65 1.242.977 1.863.14-.05.278-.1.416-.147-.084-.634-.28-1.275-.22-1.896.056-.616.368-1.21.567-1.812.44.36 1.004.644 1.305 1.098.96 1.454 1.824 2.972 2.788 4.57 1.277-1.237 1.246-2.595 1.194-3.942-.045-1.22-.227-2.443-.197-3.66.096-3.935.25-7.868.404-11.8.177-4.422.13-8.87.628-13.255.81-7.092 2.052-14.133 2.983-21.212.7-5.325 1.228-11.526 1.785-16.87.26-2.503.506-2.955 2.514-3.282 7.94-1.293 15.552-3.81 23.207-6.163.003 0 .026.02.025.02M114.664 180.237c-.703.097-1.234.065-1.68.246-4.48 1.815-9.133 2.85-13.955 3.19-.81.056-1.273-.012-1.438-.906-.147-.79-.635-1.183-1.536-1.05-2.453.363-4.91.83-7.377.933-1.776.072-3.7 1.444-5.39-.32-.07-.068-.32.04-.487.06-2.67.342-5.334.748-8.013 1.01-6.698.645-13.395 1.61-20.105 1.726-6.798.116-13.607-.72-20.418-.973-4.362-.164-8.736-.032-13.166-.032.268.1.498.183.967.354-.494.188-.747.295-1.008.38-3.03.976-6.068 1.926-9.085 2.942-.514.173-.935.623-1.513 1.025l1.187.76c-.88.737-1.657 1.388-2.318 1.944 1.374 1.61 2.753 3.03 2.64 5.29l1.298.458-1.415 1.07c.143-.003.28-.005.407-.004 1.926.017 2.218.603 2.278 3.564.28.09.58.142.834.277 1.974 1.062 4.047 1.597 6.302 1.27.497-.07 1.01-.117 1.51-.078 7.416.592 14.845 1.087 22.246 1.834 8.078.816 16.102.933 24.15-.366 5.762-.928 11.307-2.557 16.773-4.52 4.38-1.573 8.688-3.37 13.324-4.127 1.194-.196 2.36-.564 3.537-.853-3.057.267-5.998 1.448-9.19.732.17-.44.408-.688.7-.81 1.537-.64 3.056-1.346 4.64-1.842 3.174-.996 6.5-1.51 9.31-3.536 1.308-.94 2.868-1.528 4.56-2.404-1.33.308-2.39.53-3.44.8-1.338.345-1.334.36-2.758-.142 1.23-.388 2.683-.362 2.857-2.036.008-.085.174-.187.287-.225 1.088-.378 2.182-.744 3.354-1.14.067-.172.197-.5.425-1.07l-3.688 1.503-.165-.287c.906-.65 1.81-1.3 2.505-1.797-.148-1.577 1.517-1.543 2.05-2.85M108.847 85.3c-.047 1.867-.336 3.736-.617 5.57-1.427 9.3-5.68 16.555-5.62 16.593-.996 1.488-1.57 3.035-2.66 4.45-2.573 3.337-6.56 4.696-9.922 6.925-.14.093-.338.167-.5.152-3.118-.312-5.518 1.453-8.053 2.8-3.304 1.76-11.98 7.306-19.8 8.465-3.53.52-12.245 1.372-20.915-5.886-6.524-5.464-10.37-14.446-11.086-16.263-2.707-6.854-4.415-16.263-4.606-18.683-.388-4.9-.844-9.92-.427-15.743.463-6.43 1.846-13.384 3.99-18.06 2.58-5.63 5.97-14.19 18.92-21.82 5.34-3.143 10.464-4.446 14.865-4.863 5.575-.53 11.074.068 16.476 1.414 4.632 1.156 8.915 3.17 12.786 5.977 8.19 5.938 13.072 16.354 15.49 25.78.54 2.113 2.085 6.903 1.68 23.194m-16.093 56.69c1.462-.818 1.847-1.548 3.32-2.345 1.31-.72 1.65.13.32.698-4.067 3.472-7.262 5.66-11.6 8.364-2.665 1.663-5.6 2.942-8.52 4.14-4.266 1.753-8.687 2.93-13.39 2.468-.58-.056-1.17-.007-1.758.002 1.213.163 3.14.45 4.766.583.002.088-1.25.06-1.25.148-1.79 0-3.602.18-5.364-.042-2.945-.37-5.93-.756-8.767-1.59-3.212-.944-6.275-2.39-9.404-3.614-.33-.13-.73-.412-.997-.324-1.407.463-3.834-.777-4.69-1.455-1.548-1.226-9.112-8.19-6.617-6.62 6.807 4.585 9.895 5.553 16.056 7.38.738.22 7.81 1.425 8.61 1.382-.227-.074-.454-.15-.68-.225l.015-.174c1.98 0 5.373.188 7.352.21 9.98.116 14.52-1.076 18.77-2.278 4.972-1.406 9.35-4.196 13.826-6.707M66.667 18.073c.736-.018 3.202-.12 2.116-.326-1.872-.352-6.022-.637-9.06-.65-.956-.002-1.092-.3-.01-.376 1.74-.17 5.49-.493 10.834-.235l.038-.195c-1.527-.154-8.91-1.256-5.763-1.31 10.93-.596 18.964 2.86 23.633 8.23-1.224-.704-2.256-1.296-3.29-1.888l-.1.192 9 7.033c1.23 1.256-.112.604-.372.446-1.54-1.258-6.207-3.734-6.44-3.828-1.862-.748-2.716-1.223-4.618-1.84-2.468-.802-4.592-1.587-7.1-2.27-1.48-.402-3.353-.707-4.85-1.014-2.183-.45-5.05-.525-7.273-.693-6.425-.487-12.45 1.262-12.477.786 4.178-2.047 12.847-2.06 15.732-2.06m52.84 42.322c-.112-1.08-.263-2.16-.326-3.246-.07-1.185-.075-2.396-.26-3.557-.283-1.764-.72-3.51-1.18-5.238-.43-1.61-.975-3.18-1.586-4.727-.138-.48-.283-.945-.452-1.367-2.543-6.38-9.466-17.158-13.19-19.507 1.51 1.815 2.86 3.343 4.097 4.96 1.21 1.59 1.985 3.217 3.13 4.857-.1.068.115.187.016.255-3.463-4.59-6.962-9.147-11.716-12.524-.02-.014-.608-.28-.227.16l.694.863c-.386 0-.384.302-.935 0l6.956 7.71c-.43.27-1.255-.736-1.34-.654-6.41-7.115-12.33-12.495-21.692-15.445 3.913 1.455 8.402 3.584 10.895 6.32.282.298-.75-.21-1.035-.29-.738-.167-.738.097-.27.35.4.276.92 1.762-.604.818-1.882-1.286-4.352-2.37-5.966-3.472-.485.41.468.788.41.836 3.258 2.42 7.16 5.262 10.453 7.71-.087.118 1.546 1.626-.87-.04-2.634-1.866-5.134-3.97-7.938-5.53-2.86-1.59-5.872-3.185-9-4.154-3.092-.96-5.968-1.282-9.194-1.71-6.46-.856-10.51-.42-17.13.774-4.108.163 8.586-3.472 16.613-3.588 0-.146.002-.29.003-.435l-10.1-.443-.008-.164c2.67-.53 8.412-.494 11.082-1.026-.44-.178-.876-.194-1.304-.17-3.903.212-8.786-.412-16.69 1.52-6.8 1.663-13.488 3.764-19.284 7.68C17.41 27.485 11.633 37.494 8.032 43.92c-1.45 2.588-2.616 5.403-3.666 8.21-.705 1.885-1.007 3.92-1.388 5.475-.562.33-.985.43-1.122.683-.757 1.393-.676 3.006-.867 4.5C.49 66.715.178 70.68.033 74.64c-.108 2.957.076 5.933.278 8.89.357 5.228 1.485 10.32 2.875 15.36.368 1.33 2.513 8.187 5.066 14.478 2.553 6.287 8.644 17.337 10.49 20.55 3.847 6.697 8.397 12.862 14.52 17.69 2.12 1.672 4.332 3.267 6.662 4.62 1.597.927 3.507 1.296 5.212 2.06 4.37 1.952 9.01 2.652 13.704 2.675 4.414.02 8.73-.93 13.035-2.027 4.96-1.266 8.274-2.667 12.912-4.73 1.104-.49 1.296-.667 2.334-1.31.75-.452 2.052-1.464.933-.98-1.1.466-1.143.558-2.243 1.024-.403.12-2.924 1.374-.204-.373 6.395-4.03 6.882-5.332 10.137-8.425 1.95-1.93 1.073-1.214-.216-.678-3.472 2.306-.444-1.5 1.626-3.12 1.387-1.414 1.25-1.273.543-1.79-.543-.27-4.963 2.93-5.357 2.486-.367-.396 3.04-4 5.075-6.043-.026-.058.96-1.487-.207-.51-.523.187-11.663 5.75-12.097 5.642-.108-.6 12.937-5.953 14.43-8.465.413-.694-1.06.476-1.07-.263-.008-.603.257-1.763.505-2.355.182-.438.62-.848.62-1.27.007-1.547.89-2.444 2.048-3.237.33-.228.605-.594.803-.952.804-1.45-.953-1.252 2.464-4.615.353-.665-1.71-2.606-2.387-4.165-.44-1.01-.624-1.66-.387-2.69.253-1.1 2.78-5.65 3.457-6.714 1.058.162-1.058 3.092-1.027 3.424.244-.27.987-1.277 1.136-1.58.938-1.9 1.196-2.114 1.956-4.086 1.327-3.443 1.945-5.357 3.03-9.09.488-1.7.888-3.135.95-3.416.902-4.11 3.484-17.505 3.484-17.505 1.6 3.972-.417 9.958-.5 14.035 1.172-6.176 2.653-15.292 2.253-21.592.038-1.185-.036-1.93-.165-2.894-.068-.507-.202-1.14.225-1.725.182-.106.392.242.435.393.153.54.266 1.095.352 1.65.197 1.28.37 2.56.575 4.012.098-1.472-.393-2.755-.156-4.06.117.164.128.36.226.496.096.136.3.307.42.282.14-.028.314-.238.343-.393.04-.22-.062-.46-.06-.692 0-.235.058-.718.058-.718.077-.74-.42-2.054-.67-3.07-.117-.478-.3-.94-.424-1.414-.465-1.78-.908-3.567-1.375-5.347-.15-.564-.905-2.61-1.116-3.28.215.112.948 1.71.95 1.72h.13l.022-.023.015.024c.037.055.08.11.103.17 1.208 3.083 2.093 6.283 2.51 9.562.026.2.087.396.13.592.055-.013.108-.025.16-.04-.018-.15-.04-.296-.056-.443M430.752 111.072c3.305-3.218 5.257-6.398 8.255-9.917 1.176-1.38 2.78-3.634 4.032-4.967-.518.55-1.924 1.707-2.283 2.13-3.07 3.604-4.77 5.43-7.854 9.02-1.586 1.85-3.064 3.33-4.896 4.9-2.3 1.968-4.705 3.94-7.203 5.672-.267.185-.97.375-1.128.5.354-.28 1.405-1.376 2.075-2.024 1.894-1.832 3.75-3.703 5.57-5.606.79-.827 1.418-1.81 2.19-2.653 1.19-1.297 2.422-2.553 3.664-3.8 1.94-1.948.066-.635-.282-.353-.307.25-.627.487-.927.745-3.516 3.003-6.896 6.184-10.575 8.97-4.958 3.757-10.318 6.93-16.49 8.254-1.784.384-3.915.432-5.586-.186-3.854-1.42-6.828-4.136-9.004-7.674-.614-1-.63-1.816.194-2.748 2.48-2.808 4.817-5.772 7.382-8.458 5.662-5.93 7.838-11.085 10.025-18.076.324-1.032.382-2.13.47-3.187.21-2.46-.88-5.258-1.124-6.084 1.23 4.178-.536 7.235-1.954 10.25.316-3.227 1.02-5.344 1.204-8.374.174-2.9.183-6.8-2.595-8.927-.94-.722-1.866-1.53-2.583-2.463-.75-.98-6.03-1.027-9.524 1.548-5.816 4.286-8.86 10.89-11.322 17.693-2.245 6.204-3.223 12.467-2.77 19.03.35 5.098 1.236 9.816 3.09 14.493 1.29 3.26 3.333 6.632 5.35 9.498 2.482 3.524 5.424 5.037 8.607 6.15 6.438 2.25 10.81 1.634 16.58-.223 3.194-1.028 6.098-2.968 9.13-4.505 3.887-1.97 6.745-5.697 8.915-9.4.71-1.208 1.226-1.852 1.913-3.075.69-1.233 1.862-3.148 2.587-4.36-.127-.085-.73.625-1.27 1.125-.99.913-1.484 1.198-2.542 2.03-.287.227-.992.644-.75.234 2.688-4.535.78-2.668.78-2.668l-10.872 9.224c-.16.188-.442.41-.874.637.315-.162.378-.195-.02.013.007-.005.012-.01.02-.013-.798.41-3.264 1.667-4.323 2.116-5.526 2.34-1.417-.012-.44-.55 1.03-.557 3.565-1.916 4.285-2.307-.03.017-.053.022-.085.04.374-.198.346-.18.085-.04.545-.275.94-.384 1.192-.382.07-1.104.514-.68 1.294-1.335 3.634-3.058 6.997-6.61 10.392-9.918m-43.06-8.9c-.206.334-.37.88-.723.903l-.198-.008c-.94-.236-.806-3.828-.473-5.745 3.043-17.503 7-21.09 8.52-23.177.25-.344 1.844-1.938 3.502-1.616.703.135 5.08 1.553-10.63 29.642m22.67 21.983c-1.515.77-2.792 1.563-5.73 2.375l.767-.625c.393-.174.656-.45.967-.64v-.52c.103.306.197.36.28.16.085-.2.297-.355.636-.47.104.305.147.377.127.21-.017-.162.043-.27.178-.313 1.14-.213 2.41-.516 3.607-1.22 1.2-.7 2.334-1.037 3.504-1.602-1.678 1.078-2.82 1.88-4.34 2.645m7.616-4.26s-2.1 1.03-2.953 1.424c.722-.6 3.074-2.94 2.36-2.33.668-.572.593.906.593.906"/>
            </Logo>
          </Link>

          <MenuItems>
            <MenuItem to="/">
              <FormattedMessage {...messages.pageOverview} />
            </MenuItem>
            <MenuItem to="/ideas">
              <FormattedMessage {...messages.pageIdeas} />
            </MenuItem>
            <MenuItem to="/projects">
              <FormattedMessage {...messages.pageProjects} />
            </MenuItem>
          </MenuItems>
        </Left>
        <Right>
          {currentUser ?
            <div>
              <Button onClick={this.goTo('/ideas/new')}>
                <ButtonIcon height="100%" viewBox="0 0 24 24">
                  <path fill="none" d="M0 0h24v24H0V0z" /><path d="M6.57 21.64c0 .394.32.716.716.716h2.867c.394 0 .717-.322.717-.717v-.718h-4.3v.717zM8.72 8.02C5.95 8.02 3.7 10.273 3.7 13.04c0 1.704.853 3.202 2.15 4.112v1.62c0 .394.322.716.717.716h4.3c.393 0 .716-.322.716-.717v-1.618c1.298-.91 2.15-2.408 2.15-4.113 0-2.768-2.25-5.02-5.017-5.02zm2.04 7.957l-.608.43v1.648H7.286v-1.648l-.61-.43c-.967-.674-1.54-1.77-1.54-2.938 0-1.98 1.605-3.585 3.583-3.585s3.583 1.605 3.583 3.584c0 1.167-.574 2.263-1.542 2.937zM20.3 7.245h-3.61v3.61h-1.202v-3.61h-3.61V6.042h3.61v-3.61h1.202v3.61h3.61v1.203z" />
                </ButtonIcon>
                <ButtonText>
                  <FormattedMessage {...messages.addIdea} />
                </ButtonText>
              </Button>
              <User onClick={this.toggleDropdown} onClickOutside={this.closeDropdown}>
                <UserImage avatar src={avatar}></UserImage>
                {this.state.dropdownOpened ?
                  <Dropdown>
                    <Authorize action={['users', 'admin']} >
                      <DropdownItem onClick={this.goTo('/admin')}>
                        <FormattedMessage {...messages.admin} />
                      </DropdownItem>
                    </Authorize>
                    <DropdownItem onClick={this.goTo('/profile/edit')}>
                      <FormattedMessage {...messages.editProfile} />
                    </DropdownItem>
                    <DropdownItem onClick={this.props.signOut}>
                      <FormattedMessage {...messages.signOut} />
                    </DropdownItem>
                  </Dropdown>
                  :
                  null
                }
              </User>
            </div>
           :
            <div>
              <Button secondary onClick={this.goTo('/sign-in')}>
                <ButtonText><FormattedMessage {...messages.login} /></ButtonText>
              </Button>
              <Button onClick={this.goTo('/register')}>
                <ButtonText><FormattedMessage {...messages.register} /></ButtonText>
              </Button>
            </div>
           }
        </Right>
      </Container>
    );
  }
}

Navbar.propTypes = {
  currentUser: PropTypes.object,
  currentTenant: PropTypes.object.isRequired,
  signOut: PropTypes.func.isRequired,
  goTo: PropTypes.func.isRequired,
};

const mapStateToProps = createStructuredSelector({
  currentUser: makeSelectCurrentUserImmutable(),
});

const mergeProps = (stateP, dispatchP, ownP) => {
  const signOut = dispatchP.signOutCurrentUser;
  const goTo = dispatchP.push;
  return Object.assign({}, stateP, { signOut, goTo }, ownP);
};

export default injectIntl(preprocess(mapStateToProps, { signOutCurrentUser, push }, mergeProps)(Navbar));
